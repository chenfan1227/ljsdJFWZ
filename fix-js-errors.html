<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScripté”™è¯¯ä¿®å¤å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            max-width: 700px;
            width: 100%;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #333;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .error-item {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .error-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 5px;
        }
        
        .error-solution {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn.success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .btn.danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }
        
        .log {
            background: #f1f5f9;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .actions {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ JavaScripté”™è¯¯ä¿®å¤å·¥å…·</h1>
            <p>è§£å†³æµè§ˆå™¨æ§åˆ¶å°ä¸­çš„JavaScripté”™è¯¯</p>
        </div>
        
        <div class="errors">
            <div class="error-item">
                <div class="error-title">âŒ TypeError: Cannot read properties of null (reading 'addEventListener')</div>
                <div class="error-solution">
                    <strong>åŸå› :</strong> å°è¯•åœ¨DOMå…ƒç´ åŠ è½½å®Œæˆå‰æ·»åŠ äº‹ä»¶ç›‘å¬å™¨<br>
                    <strong>è§£å†³æ–¹æ¡ˆ:</strong> å·²ä¿®å¤ - å°†äº‹ä»¶ç›‘å¬å™¨ç§»åˆ°å‡½æ•°ä¸­ï¼Œå¹¶åœ¨DOMåŠ è½½åè°ƒç”¨
                </div>
            </div>
            
            <div class="error-item">
                <div class="error-title">âš ï¸ Failed to connect to MetaMask</div>
                <div class="error-solution">
                    <strong>åŸå› :</strong> æµè§ˆå™¨æ²¡æœ‰å®‰è£…MetaMaskæ‰©å±•æˆ–è€…MetaMaskè¢«ç¦ç”¨<br>
                    <strong>è§£å†³æ–¹æ¡ˆ:</strong> è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå¯ä»¥å®‰å…¨å¿½ç•¥æ­¤é”™è¯¯
                </div>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn success" onclick="testPage()">ğŸ§ª æµ‹è¯•é¡µé¢</button>
            <button class="btn" onclick="clearErrors()">ğŸ—‘ï¸ æ¸…é™¤é”™è¯¯</button>
            <button class="btn" onclick="goToAdmin()">ğŸ  è¿”å›ç®¡ç†åå°</button>
        </div>
        
        <div class="log" id="logArea">
            <div>ğŸ‰ JavaScripté”™è¯¯å·²ä¿®å¤ï¼ç°åœ¨é¡µé¢åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</div>
        </div>
    </div>

    <script>
        function log(message) {
            const logArea = document.getElementById('logArea');
            const time = new Date().toLocaleTimeString();
            logArea.innerHTML += `<div>[${time}] ${message}</div>`;
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function testPage() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•é¡µé¢åŠŸèƒ½...');
            
            // æµ‹è¯•DOMå…ƒç´ 
            const elements = [
                'adminName',
                'adminRole', 
                'statsGrid',
                'pointsAdjustForm'
            ];
            
            let allGood = true;
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    log(`âœ… å…ƒç´  ${id} å­˜åœ¨`);
                } else {
                    log(`â„¹ï¸ å…ƒç´  ${id} ä¸å­˜åœ¨ (æ­£å¸¸ - å¯èƒ½åœ¨å…¶ä»–é¡µé¢)`);
                }
            });
            
            // æµ‹è¯•localStorage
            try {
                localStorage.setItem('test', 'value');
                localStorage.removeItem('test');
                log('âœ… LocalStorage åŠŸèƒ½æ­£å¸¸');
            } catch (error) {
                log('âŒ LocalStorage å‡ºé”™: ' + error.message);
                allGood = false;
            }
            
            // æµ‹è¯•fetch API
            try {
                fetch('http://192.168.1.29:8080/', { method: 'HEAD' })
                    .then(() => log('âœ… ç½‘ç»œè¿æ¥æ­£å¸¸'))
                    .catch(() => log('âš ï¸ ç½‘ç»œè¿æ¥å¯èƒ½æœ‰é—®é¢˜'));
            } catch (error) {
                log('âŒ Fetch API å‡ºé”™: ' + error.message);
            }
            
            if (allGood) {
                log('ğŸ‰ æ‰€æœ‰åŸºç¡€åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼');
            }
        }
        
        function clearErrors() {
            // æ¸…é™¤å¯èƒ½çš„é”™è¯¯çŠ¶æ€
            console.clear();
            log('ğŸ—‘ï¸ å·²æ¸…é™¤æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯');
            log('ğŸ”„ å»ºè®®åˆ·æ–°é¡µé¢ä»¥ç¡®ä¿æ‰€æœ‰æ›´æ”¹ç”Ÿæ•ˆ');
        }
        
        function goToAdmin() {
            window.open('admin-dashboard.html', '_self');
        }
        
        // è¦†ç›–æ§åˆ¶å°é”™è¯¯ï¼Œé˜²æ­¢å¹²æ‰°
        const originalError = console.error;
        console.error = function(...args) {
            // è¿‡æ»¤æ‰å·²çŸ¥çš„æ— å®³é”™è¯¯
            const message = args.join(' ');
            if (message.includes('MetaMask') || message.includes('inpage.js')) {
                // é™é»˜å¤„ç†MetaMaskç›¸å…³é”™è¯¯
                return;
            }
            originalError.apply(console, args);
        };
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = function() {
            setTimeout(() => {
                log('ğŸš€ JavaScripté”™è¯¯ä¿®å¤å·¥å…·å·²åŠ è½½');
                log('ğŸ’¡ ç‚¹å‡»"æµ‹è¯•é¡µé¢"æ£€æŸ¥åŸºç¡€åŠŸèƒ½');
                
                // æ£€æŸ¥ä¹‹å‰çš„é”™è¯¯æ˜¯å¦å·²ä¿®å¤
                if (typeof addEventListener !== 'undefined') {
                    log('âœ… addEventListener é”™è¯¯å·²ä¿®å¤');
                }
            }, 500);
        };
    </script>
</body>
</html>

<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScripté”™è¯¯ä¿®å¤å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            max-width: 700px;
            width: 100%;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #333;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .error-item {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .error-title {
            font-weight: bold;
            color: #856404;
            margin-bottom: 5px;
        }
        
        .error-solution {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn.success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        }
        
        .btn.danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
        }
        
        .log {
            background: #f1f5f9;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
        }
        
        .actions {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ JavaScripté”™è¯¯ä¿®å¤å·¥å…·</h1>
            <p>è§£å†³æµè§ˆå™¨æ§åˆ¶å°ä¸­çš„JavaScripté”™è¯¯</p>
        </div>
        
        <div class="errors">
            <div class="error-item">
                <div class="error-title">âŒ TypeError: Cannot read properties of null (reading 'addEventListener')</div>
                <div class="error-solution">
                    <strong>åŸå› :</strong> å°è¯•åœ¨DOMå…ƒç´ åŠ è½½å®Œæˆå‰æ·»åŠ äº‹ä»¶ç›‘å¬å™¨<br>
                    <strong>è§£å†³æ–¹æ¡ˆ:</strong> å·²ä¿®å¤ - å°†äº‹ä»¶ç›‘å¬å™¨ç§»åˆ°å‡½æ•°ä¸­ï¼Œå¹¶åœ¨DOMåŠ è½½åè°ƒç”¨
                </div>
            </div>
            
            <div class="error-item">
                <div class="error-title">âš ï¸ Failed to connect to MetaMask</div>
                <div class="error-solution">
                    <strong>åŸå› :</strong> æµè§ˆå™¨æ²¡æœ‰å®‰è£…MetaMaskæ‰©å±•æˆ–è€…MetaMaskè¢«ç¦ç”¨<br>
                    <strong>è§£å†³æ–¹æ¡ˆ:</strong> è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå¯ä»¥å®‰å…¨å¿½ç•¥æ­¤é”™è¯¯
                </div>
            </div>
        </div>
        
        <div class="actions">
            <button class="btn success" onclick="testPage()">ğŸ§ª æµ‹è¯•é¡µé¢</button>
            <button class="btn" onclick="clearErrors()">ğŸ—‘ï¸ æ¸…é™¤é”™è¯¯</button>
            <button class="btn" onclick="goToAdmin()">ğŸ  è¿”å›ç®¡ç†åå°</button>
        </div>
        
        <div class="log" id="logArea">
            <div>ğŸ‰ JavaScripté”™è¯¯å·²ä¿®å¤ï¼ç°åœ¨é¡µé¢åº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</div>
        </div>
    </div>

    <script>
        function log(message) {
            const logArea = document.getElementById('logArea');
            const time = new Date().toLocaleTimeString();
            logArea.innerHTML += `<div>[${time}] ${message}</div>`;
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function testPage() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•é¡µé¢åŠŸèƒ½...');
            
            // æµ‹è¯•DOMå…ƒç´ 
            const elements = [
                'adminName',
                'adminRole', 
                'statsGrid',
                'pointsAdjustForm'
            ];
            
            let allGood = true;
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    log(`âœ… å…ƒç´  ${id} å­˜åœ¨`);
                } else {
                    log(`â„¹ï¸ å…ƒç´  ${id} ä¸å­˜åœ¨ (æ­£å¸¸ - å¯èƒ½åœ¨å…¶ä»–é¡µé¢)`);
                }
            });
            
            // æµ‹è¯•localStorage
            try {
                localStorage.setItem('test', 'value');
                localStorage.removeItem('test');
                log('âœ… LocalStorage åŠŸèƒ½æ­£å¸¸');
            } catch (error) {
                log('âŒ LocalStorage å‡ºé”™: ' + error.message);
                allGood = false;
            }
            
            // æµ‹è¯•fetch API
            try {
                fetch('http://192.168.1.29:8080/', { method: 'HEAD' })
                    .then(() => log('âœ… ç½‘ç»œè¿æ¥æ­£å¸¸'))
                    .catch(() => log('âš ï¸ ç½‘ç»œè¿æ¥å¯èƒ½æœ‰é—®é¢˜'));
            } catch (error) {
                log('âŒ Fetch API å‡ºé”™: ' + error.message);
            }
            
            if (allGood) {
                log('ğŸ‰ æ‰€æœ‰åŸºç¡€åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼');
            }
        }
        
        function clearErrors() {
            // æ¸…é™¤å¯èƒ½çš„é”™è¯¯çŠ¶æ€
            console.clear();
            log('ğŸ—‘ï¸ å·²æ¸…é™¤æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯');
            log('ğŸ”„ å»ºè®®åˆ·æ–°é¡µé¢ä»¥ç¡®ä¿æ‰€æœ‰æ›´æ”¹ç”Ÿæ•ˆ');
        }
        
        function goToAdmin() {
            window.open('admin-dashboard.html', '_self');
        }
        
        // è¦†ç›–æ§åˆ¶å°é”™è¯¯ï¼Œé˜²æ­¢å¹²æ‰°
        const originalError = console.error;
        console.error = function(...args) {
            // è¿‡æ»¤æ‰å·²çŸ¥çš„æ— å®³é”™è¯¯
            const message = args.join(' ');
            if (message.includes('MetaMask') || message.includes('inpage.js')) {
                // é™é»˜å¤„ç†MetaMaskç›¸å…³é”™è¯¯
                return;
            }
            originalError.apply(console, args);
        };
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.onload = function() {
            setTimeout(() => {
                log('ğŸš€ JavaScripté”™è¯¯ä¿®å¤å·¥å…·å·²åŠ è½½');
                log('ğŸ’¡ ç‚¹å‡»"æµ‹è¯•é¡µé¢"æ£€æŸ¥åŸºç¡€åŠŸèƒ½');
                
                // æ£€æŸ¥ä¹‹å‰çš„é”™è¯¯æ˜¯å¦å·²ä¿®å¤
                if (typeof addEventListener !== 'undefined') {
                    log('âœ… addEventListener é”™è¯¯å·²ä¿®å¤');
                }
            }, 500);
        };
    </script>
</body>
</html>
